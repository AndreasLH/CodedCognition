<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Advanced Deep learning in computer vision project"><title>Image to recipe retrieval</title>
<link rel=canonical href=https://andreaslh.github.io/CodedCognition/p/hello-world/><link rel=stylesheet href=/CodedCognition/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Image to recipe retrieval"><meta property='og:description' content="Advanced Deep learning in computer vision project"><meta property='og:url' content='https://andreaslh.github.io/CodedCognition/p/hello-world/'><meta property='og:site_name' content='Coded Cognition // Andreas Lau Hansen'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CLIP'><meta property='article:tag' content='Contrastive learning'><meta property='article:published_time' content='2023-11-26T00:00:00+00:00'><meta property='article:modified_time' content='2023-11-26T00:00:00+00:00'><meta property='og:image' content='https://andreaslh.github.io/CodedCognition/p/hello-world/cover2.png'><meta name=twitter:title content="Image to recipe retrieval"><meta name=twitter:description content="Advanced Deep learning in computer vision project"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://andreaslh.github.io/CodedCognition/p/hello-world/cover2.png'><link rel="shortcut icon" href=/CodedCognition/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/CodedCognition/><img src=/CodedCognition/img/avatar_hu18252397595957545659.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/CodedCognition>Coded Cognition // Andreas Lau Hansen</a></h1><h2 class=site-description>My personal website. I want to show some of the things I have worked on and that I have found particularly interesting during my studies in AI and Data at DTU</h2></div></header><ol class=menu-social><li><a href=https://github.com/andreasLH target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/andreas-lau-hansen-332962264/ target=_blank title=LinkedIn rel=me><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 256 256" width="50" height="50" fill-rule="nonzero"><g fill="#707070" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode:normal"><g transform="scale(5.12,5.12)"><path d="M9 4C6.25048 4 4 6.25048 4 9v32c0 2.74952 2.25048 5 5 5h32c2.74952.0 5-2.25048 5-5V9c0-2.74952-2.25048-5-5-5zM9 6h32c1.66848.0 3 1.33152 3 3v32c0 1.66848-1.33152 3-3 3H9c-1.66848.0-3-1.33152-3-3V9c0-1.66848 1.33152-3 3-3zm5 5.01172c-1.09522.0-2.08078.32736-2.81055.94141-.72977.61405-1.17773 1.53139-1.17773 2.51367.0 1.86718 1.61957 3.32281 3.67969 3.4668.0013 65e-5.0026.0013.00391.00195.09817.03346.20099.05126.30469.05273 2.27301.0 3.98828-1.5922 3.98828-3.52148-18e-5-.01759-83e-5-.03518-.00195-.05274-.10175-1.90023-1.79589-3.40234-3.98633-3.40234zm0 1.97656c1.39223.0 1.94197.62176 2.00195 1.50391-.01215.85625-.54186 1.51953-2.00195 1.51953-1.38541.0-2.01172-.70949-2.01172-1.54492.0-.41771.15242-.7325.47266-1.00195.32023-.26945.83428-.47656 1.53906-.47656zM11 19c-.55226 6e-5-.99994.44774-1 1v19c6e-5.55226.44774.99994 1 1h6c.55226-6e-5.99994-.44774 1-1v-5.86523V20c-6e-5-.55226-.44774-.99994-1-1zm9 0c-.55226 6e-5-.99994.44774-1 1v19c6e-5.55226.44774.99994 1 1h6c.55226-6e-5.99994-.44774 1-1V29c0-.82967.22639-1.65497.625-2.19531.39861-.54035.90147-.86463 1.85742-.84766.98574.01695 1.50758.35464 1.90234.88477.39477.53013.61523 1.32487.61523 2.1582v10c6e-5.55226.44774.99994 1 1h6c.55226-6e-5.99994-.44774 1-1V28.26172c0-2.96154-.87721-5.30739-2.38086-6.89453C36.11548 19.78005 34.02416 19 31.81249 19c-2.10202.0-3.70165.70489-4.8125 1.42383V20c-6e-5-.55226-.44774-.99994-1-1zm-8 2h4v12.13477V38h-4zm9 0h4v1.56055c13e-5.43.27511.81179.68291.94817.40781.13638.85714-.00319 1.11591-.34661.0.0 1.57037-2.16211 5.01367-2.16211 1.75333.0 3.25687.58258 4.35547 1.74219s1.83203 2.94607 1.83203 5.51953V38h-4v-9c0-1.16667-.27953-2.37289-1.00977-3.35352-.73023-.98062-1.9584-1.66341-3.47266-1.68945-1.52204-.02703-2.77006.66996-3.50195 1.66211S24.99999 27.82967 24.99999 29v9h-4z"/></g></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/CodedCognition/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/CodedCognition/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/CodedCognition/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/CodedCognition/about-me/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>About me</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#contrastive-learning>Contrastive learning</a><ol><li><a href=#math>Math</a></li></ol></li></ol><ol><li><a href=#out-of-distribution-image>Out of distribution image</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/CodedCognition/p/hello-world/><img src=/CodedCognition/p/hello-world/cover2_hu7191200650978051845.png srcset="/CodedCognition/p/hello-world/cover2_hu7191200650978051845.png 800w, /CodedCognition/p/hello-world/cover2_hu9492448698245951676.png 1600w" width=800 height=261 loading=lazy alt="Featured image of post Image to recipe retrieval"></a></div><div class=article-details><header class=article-category><a href=/CodedCognition/categories/multi-modal/>Multi-Modal</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/CodedCognition/p/hello-world/>Image to recipe retrieval</a></h2><h3 class=article-subtitle>Advanced Deep learning in computer vision project</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 26, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>1 minute read</time></div></footer></div></header><section class=article-content><h1 id=motivation>Motivation</h1><p>I realised midways during this project that we had essentially just recreated the CLIP model.</p><h1 id=data>Data</h1><p><img src=/CodedCognition/p/hello-world/data.png width=1713 height=546 srcset="/CodedCognition/p/hello-world/data_hu18030225312439565727.png 480w, /CodedCognition/p/hello-world/data_hu3721719520517867076.png 1024w" loading=lazy alt="alt text" class=gallery-image data-flex-grow=313 data-flex-basis=752px></p><h2 id=contrastive-learning>Contrastive learning</h2><h3 id=math>Math</h3><p>$$
L_{bi} (a^{n=i}, b^{n=i}, b^{b\neq i}, a^{n\neq i}) = \frac{1}{B} \sum_{j=1}^B L^\prime_{bi}(i,j)\delta(i,j)
$$</p><p><img src=/CodedCognition/p/hello-world/contrast.png width=900 height=442 srcset="/CodedCognition/p/hello-world/contrast_hu4121234433444749986.png 480w, /CodedCognition/p/hello-world/contrast_hu3149316029614551298.png 1024w" loading=lazy alt="alt text" class=gallery-image data-flex-grow=203 data-flex-basis=488px> <img src=/CodedCognition/p/hello-world/PCA.png width=1015 height=829 srcset="/CodedCognition/p/hello-world/PCA_hu274456097910932506.png 480w, /CodedCognition/p/hello-world/PCA_hu5569010005091693709.png 1024w" loading=lazy alt="alt text" class=gallery-image data-flex-grow=122 data-flex-basis=293px></p><h1 id=model>Model</h1><p><img src=/CodedCognition/p/hello-world/model.png width=1370 height=587 srcset="/CodedCognition/p/hello-world/model_hu1529365347401631037.png 480w, /CodedCognition/p/hello-world/model_hu11883857552261529226.png 1024w" loading=lazy alt="alt text" class=gallery-image data-flex-grow=233 data-flex-basis=560px></p><h1 id=results>Results</h1><p>We can go both forwards and backwards between images and text.</p><p><img src=/CodedCognition/p/hello-world/results.png width=1281 height=1121 srcset="/CodedCognition/p/hello-world/results_hu12657805338290030343.png 480w, /CodedCognition/p/hello-world/results_hu3945010227499800399.png 1024w" loading=lazy alt="Images and recipies" class=gallery-image data-flex-grow=114 data-flex-basis=274px></p><h2 id=out-of-distribution-image>Out of distribution image</h2><p><img src=/CodedCognition/p/hello-world/OOD.png width=1547 height=159 srcset="/CodedCognition/p/hello-world/OOD_hu6967952611363395337.png 480w, /CodedCognition/p/hello-world/OOD_hu5742916082539157431.png 1024w" loading=lazy alt="alt text" class=gallery-image data-flex-grow=972 data-flex-basis=2335px></p></section><footer class=article-footer><section class=article-tags><a href=/CodedCognition/tags/clip/>CLIP</a>
<a href=/CodedCognition/tags/contrastive-learning/>Contrastive Learning</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><footer class=site-footer><section class=copyright>&copy;
2019 -
2024 Coded Cognition // Andreas Lau Hansen</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/CodedCognition/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>